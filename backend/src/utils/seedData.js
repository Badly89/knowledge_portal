import { getConnection } from './database.js';
import bcrypt from 'bcryptjs';

export const seedInitialData = async () => {
  let conn;
  try {
    conn = await getConnection();

    // Добавляем тестовые категории на русском
    const categories = [
      {
        name: 'Техническая документация',
        description: 'Документация по техническим вопросам, инструкции и руководства'
      },
      {
        name: 'Часто задаваемые вопросы',
        description: 'Ответы на наиболее распространенные вопросы пользователей'
      },
      {
        name: 'Руководства пользователя',
        description: 'Подробные руководства по использованию системы и ее функций'
      },
      {
        name: 'Политики и процедуры',
        description: 'Корпоративные политики, рабочие процедуры и регламенты'
      },
      {
        name: 'Обучение и развитие',
        description: 'Материалы для обучения сотрудников и развития компетенций'
      }
    ];

    for (const category of categories) {
      await conn.query(
        'INSERT IGNORE INTO categories (name, description, created_by) VALUES (?, ?, ?)',
        [category.name, category.description, 1]
      );
    }

    // Добавляем тестовые статьи на русском
    const articles = [
      {
        title: 'Как создать новую статью в базе знаний',
        content: `В этом руководстве вы узнаете, как создавать новые статьи в системе базы знаний.\n\n## Шаги по созданию статьи:\n\n1. Перейдите в раздел "Статьи"\n2. Нажмите кнопку "Создать статью"\n3. Заполните обязательные поля:\n   - Название статьи\n   - Выберите категорию\n   - Введите содержание\n4. При необходимости прикрепите файлы или изображения\n5. Нажмите "Создать статью"\n\n## Советы:\n\n- Используйте четкие и описательные названия\n- Структурируйте содержание с помощью заголовков\n- Добавляйте соответствующие категории для лучшей навигации`,
        category_id: 3
      },
      {
        title: 'Частые проблемы при входе в систему',
        content: `Если у вас возникают проблемы при входе в систему, следуйте этим рекомендациям:\n\n## Возможные причины и решения:\n\n### Неверный логин или пароль\n- Проверьте правильность ввода учетных данных\n- Воспользуйтесь функцией восстановления пароля\n\n### Проблемы с браузером\n- Очистите кэш браузера\n- Попробуйте использовать другой браузер\n- Проверьте настройки cookies и JavaScript\n\n### Сетеые проблемы\n- Проверьте подключение к интернету\n- Убедитесь, что корпоративная сеть не блокирует доступ\n\nЕсли проблемы сохраняются, обратитесь в техническую поддержку.`,
        category_id: 2
      }
    ];

    for (const article of articles) {
      await conn.query(
        `INSERT INTO articles (title, content, category_id, created_by) 
         VALUES (?, ?, ?, ?)`,
        [article.title, article.content, article.category_id, 1]
      );
    }

    console.log('Тестовые данные на русском языке успешно добавлены');
  } catch (error) {
    console.error('Ошибка добавления тестовых данных:', error);
  } finally {
    if (conn) conn.release();
  }
};

// Запускаем добавление тестовых данных при инициализации
// seedInitialData();